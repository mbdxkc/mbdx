/* =====================================================
   mBdx â€” homepage rive loader
   lazy-load rive for better LCP
   ===================================================== */

(function () {
  function loadRive() {
    var script = document.createElement('script');
    script.src = '/js/rive.min.js';
    script.onload = function () {
      initLogoAnimation();

      if (typeof window.initHeaderWordmark === 'function') {
        window.initHeaderWordmark();
      }
    };
    document.head.appendChild(script);
  }

  function initLogoAnimation() {
    var canvas = document.getElementById('mb_logo_riv');
    var placeholder = document.getElementById('mb_logo_placeholder');

    if (!canvas || typeof rive === 'undefined') return;

    new rive.Rive({
      src: '/media/mb_logo.riv',
      canvas: canvas,
      autoplay: true,
      stateMachines: 'State Machine 1',
      onLoad: function () {
        if (placeholder) {
          placeholder.style.transition = 'opacity 0.3s ease';
          placeholder.style.opacity = '0';

          setTimeout(function () {
            placeholder.style.display = 'none';
            canvas.style.display = 'block';
          }, 300);
        } else {
          canvas.style.display = 'block';
        }
      }
    });
  }

  if (document.readyState === 'complete') {
    setTimeout(loadRive, 100);
  } else {
    window.addEventListener('load', function () {
      setTimeout(loadRive, 100);
    });
  }
})();
